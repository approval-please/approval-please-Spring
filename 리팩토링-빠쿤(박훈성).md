# ⚙️ 리팩토링 기록 - 빠쿤(박훈성) (23.05 ~)
                                                             
## QueryDsl exists 메서드 성능 개선 (23.05.01)
![img_1.png](https://user-images.githubusercontent.com/71416677/235453056-63f5eb41-0334-4ee7-bca6-ddaedc853d60.png)                         
- 기존 exists 관련 메서드는 내부적으로 count 쿼리를 통해 동작
- exists 쿼리의 경우, 조건에 해당하는 row 발견 시 쿼리가 종료
- 그러나 count 쿼리의 경우, 조건에 해당하는 row가 발견되어도 테이블의 끝까지 모두 스캔하므로 성능 저하
- 이를 해결하기 위해 QueryDsl의 selectOne과 fetchFirst를 통해 성능 개선 진행

![img_2.png](https://user-images.githubusercontent.com/71416677/235453064-ce3d4f03-e627-4ee8-ab00-ed9af4a00ca5.png)                                     
- fetchFirst를 통해 where절 조건에 해당하는 row가 발견되면 쿼리를 종료함으로써 exists 쿼리와 동등한 동작을 수행
- 이 때, 조건에 해당하는 row가 발견되지 않으면 fetchFirst의 결과가 null이므로, null 여부를 통해 exists의 결과를 반환
- 블로그 포스팅: [exists 메서드 성능 개선 - count vs exists](https://hungseong.tistory.com/73)
